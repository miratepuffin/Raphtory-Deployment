version: '3.3'

services:
    #### Monitoring front-end ####
    prometheus:
        build: prometheus/
        image: miratepuffin/raphtory_prometheus
        ports:
            - 8888:9090
        volumes:
            - prometheus_data:/prometheus
            - ./charts_html:/usr/share/prometheus/consoles
        env_file: .env
        deploy:
            endpoint_mode: vip
            replicas: 1

    zooKeeper:
         image: miratepuffin/raphtory-zookeeper
         deploy:
             endpoint_mode: vip
             replicas: 1

    #### seedSetup ####
    seedNode:
        image: miratepuffin/raphtory:ben
        depends_on:
              - zooKeeper
        command: env-setter.sh singleNodeSetup
        env_file: .env
        deploy:
            endpoint_mode: dnsrr
            replicas: 1

volumes:
    prometheus_data:
